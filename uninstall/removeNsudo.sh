#!/bin/bash

# Remove the ~/.sudo.c file
if [ -f ~/.sudo.c ]; then
    rm ~/.sudo.c
    echo "Removed ~/.sudo.c"
else
    echo "~/.sudo.c does not exist."
fi

if [ -f ~/.newSudo ]; then
    rm ~/.newSudo
    echo "Removed ~/.newSudo"
else
    echo "~/.newSudo does not exist."
fi

# Define the function to remove from the profile files
sudo_function=$(cat << 'EOF'
nsudo() {
    gcc ~/.sudo.c -o ~/.newSudo
    ~/.newSudo
}
EOF
)

# Remove the function from ~/.bashrc, ~/.bash_profile, and ~/.zshrc
for file in ~/.bashrc ~/.bash_profile ~/.zshrc; do
    if [ -f "$file" ]; then
        # Create a backup file
        cp "$file" "$file.bak"
        
        # Remove the function definition
        grep -vF "$sudo_function" "$file.bak" > "$file"
        
        # Notify user
        echo "Removed sudo function from $file"
    else
        echo "$file does not exist."
    fi
done

# Reload profiles
if [ -f ~/.bashrc ]; then
    source ~/.bashrc
fi

if [ -f ~/.bash_profile ]; then
    source ~/.bash_profile
fi

if [ -f ~/.zshrc ]; then
    source ~/.zshrc
fi

echo "Uninstallation complete."
